project('libgit2', 'c')
cm_git2_dir = include_directories(
  'src',
  'include',
  'deps/http-parser',
  'deps/zlib',
  '__CMake_build',
  '.'
)
cm_git2_sys = include_directories(is_system : true)
cm_git2_inc = [cm_git2_dir, cm_git2_sys]
cm_git2_src = files(
  'src/annotated_commit.c',
  'src/apply.c',
  'src/attr.c',
  'src/attr_file.c',
  'src/attrcache.c',
  'src/blame.c',
  'src/blame_git.c',
  'src/blob.c',
  'src/branch.c',
  'src/buf_text.c',
  'src/buffer.c',
  'src/cache.c',
  'src/checkout.c',
  'src/cherrypick.c',
  'src/clone.c',
  'src/commit.c',
  'src/commit_list.c',
  'src/config.c',
  'src/config_cache.c',
  'src/config_file.c',
  'src/crlf.c',
  'src/curl_stream.c',
  'src/date.c',
  'src/delta.c',
  'src/describe.c',
  'src/diff.c',
  'src/diff_driver.c',
  'src/diff_file.c',
  'src/diff_generate.c',
  'src/diff_parse.c',
  'src/diff_print.c',
  'src/diff_stats.c',
  'src/diff_tform.c',
  'src/diff_xdiff.c',
  'src/errors.c',
  'src/fetch.c',
  'src/fetchhead.c',
  'src/filebuf.c',
  'src/fileops.c',
  'src/filter.c',
  'src/fnmatch.c',
  'src/global.c',
  'src/graph.c',
  'src/hash.c',
  'src/hashsig.c',
  'src/ident.c',
  'src/ignore.c',
  'src/index.c',
  'src/indexer.c',
  'src/iterator.c',
  'src/merge.c',
  'src/merge_driver.c',
  'src/merge_file.c',
  'src/message.c',
  'src/mwindow.c',
  'src/netops.c',
  'src/notes.c',
  'src/object.c',
  'src/object_api.c',
  'src/odb.c',
  'src/odb_loose.c',
  'src/odb_mempack.c',
  'src/odb_pack.c',
  'src/oid.c',
  'src/oidarray.c',
  'src/openssl_stream.c',
  'src/pack-objects.c',
  'src/pack.c',
  'src/patch.c',
  'src/patch_generate.c',
  'src/patch_parse.c',
  'src/path.c',
  'src/pathspec.c',
  'src/pool.c',
  'src/posix.c',
  'src/pqueue.c',
  'src/proxy.c',
  'src/push.c',
  'src/rebase.c',
  'src/refdb.c',
  'src/refdb_fs.c',
  'src/reflog.c',
  'src/refs.c',
  'src/refspec.c',
  'src/remote.c',
  'src/repository.c',
  'src/reset.c',
  'src/revert.c',
  'src/revparse.c',
  'src/revwalk.c',
  'src/settings.c',
  'src/sha1_lookup.c',
  'src/signature.c',
  'src/socket_stream.c',
  'src/sortedcache.c',
  'src/stash.c',
  'src/status.c',
  'src/stransport_stream.c',
  'src/strmap.c',
  'src/submodule.c',
  'src/sysdir.c',
  'src/tag.c',
  'src/thread-utils.c',
  'src/tls_stream.c',
  'src/trace.c',
  'src/transaction.c',
  'src/transport.c',
  'src/transports/auth.c',
  'src/transports/auth_negotiate.c',
  'src/transports/cred.c',
  'src/transports/cred_helpers.c',
  'src/transports/git.c',
  'src/transports/http.c',
  'src/transports/local.c',
  'src/transports/smart.c',
  'src/transports/smart_pkt.c',
  'src/transports/smart_protocol.c',
  'src/transports/ssh.c',
  'src/transports/winhttp.c',
  'src/tree-cache.c',
  'src/tree.c',
  'src/tsort.c',
  'src/util.c',
  'src/varint.c',
  'src/vector.c',
  'src/xdiff/xdiffi.c',
  'src/xdiff/xemit.c',
  'src/xdiff/xhistogram.c',
  'src/xdiff/xmerge.c',
  'src/xdiff/xpatience.c',
  'src/xdiff/xprepare.c',
  'src/xdiff/xutils.c',
  'src/zstream.c',
  'src/unix/map.c',
  'src/unix/realpath.c',
  'deps/zlib/adler32.c',
  'deps/zlib/crc32.c',
  'deps/zlib/deflate.c',
  'deps/zlib/infback.c',
  'deps/zlib/inffast.c',
  'deps/zlib/inflate.c',
  'deps/zlib/inftrees.c',
  'deps/zlib/trees.c',
  'deps/zlib/zutil.c',
  'deps/http-parser/http_parser.c',
  'src/hash/hash_generic.c',
  'include/git2.h',
  'include/git2/annotated_commit.h',
  'include/git2/attr.h',
  'include/git2/blame.h',
  'include/git2/blob.h',
  'include/git2/branch.h',
  'include/git2/buffer.h',
  'include/git2/checkout.h',
  'include/git2/cherrypick.h',
  'include/git2/clone.h',
  'include/git2/commit.h',
  'include/git2/common.h',
  'include/git2/config.h',
  'include/git2/cred_helpers.h',
  'include/git2/describe.h',
  'include/git2/diff.h',
  'include/git2/errors.h',
  'include/git2/filter.h',
  'include/git2/global.h',
  'include/git2/graph.h',
  'include/git2/ignore.h',
  'include/git2/index.h',
  'include/git2/indexer.h',
  'include/git2/inttypes.h',
  'include/git2/merge.h',
  'include/git2/message.h',
  'include/git2/net.h',
  'include/git2/notes.h',
  'include/git2/object.h',
  'include/git2/odb.h',
  'include/git2/odb_backend.h',
  'include/git2/oid.h',
  'include/git2/oidarray.h',
  'include/git2/pack.h',
  'include/git2/patch.h',
  'include/git2/pathspec.h',
  'include/git2/proxy.h',
  'include/git2/rebase.h',
  'include/git2/refdb.h',
  'include/git2/reflog.h',
  'include/git2/refs.h',
  'include/git2/refspec.h',
  'include/git2/remote.h',
  'include/git2/repository.h',
  'include/git2/reset.h',
  'include/git2/revert.h',
  'include/git2/revparse.h',
  'include/git2/revwalk.h',
  'include/git2/signature.h',
  'include/git2/stash.h',
  'include/git2/status.h',
  'include/git2/stdint.h',
  'include/git2/strarray.h',
  'include/git2/submodule.h',
  'include/git2/sys/commit.h',
  'include/git2/sys/config.h',
  'include/git2/sys/diff.h',
  'include/git2/sys/filter.h',
  'include/git2/sys/hashsig.h',
  'include/git2/sys/index.h',
  'include/git2/sys/mempack.h',
  'include/git2/sys/merge.h',
  'include/git2/sys/odb_backend.h',
  'include/git2/sys/openssl.h',
  'include/git2/sys/refdb_backend.h',
  'include/git2/sys/reflog.h',
  'include/git2/sys/refs.h',
  'include/git2/sys/remote.h',
  'include/git2/sys/repository.h',
  'include/git2/sys/stream.h',
  'include/git2/sys/time.h',
  'include/git2/sys/transport.h',
  'include/git2/tag.h',
  'include/git2/trace.h',
  'include/git2/transaction.h',
  'include/git2/transport.h',
  'include/git2/tree.h',
  'include/git2/types.h',
  'include/git2/version.h',
  'src/annotated_commit.h',
  'src/apply.h',
  'src/array.h',
  'src/attr.h',
  'src/attr_file.h',
  'src/attrcache.h',
  'src/bitvec.h',
  'src/blame.h',
  'src/blame_git.h',
  'src/blob.h',
  'src/branch.h',
  'src/buf_text.h',
  'src/buffer.h',
  'src/cache.h',
  'src/cc-compat.h',
  'src/checkout.h',
  'src/clone.h',
  'src/commit.h',
  'src/commit_list.h',
  'src/common.h',
  'src/config.h',
  'src/config_file.h',
  'src/curl_stream.h',
  'src/delta.h',
  'src/diff.h',
  'src/diff_driver.h',
  'src/diff_file.h',
  'src/diff_generate.h',
  'src/diff_parse.h',
  'src/diff_tform.h',
  'src/diff_xdiff.h',
  'src/fetch.h',
  'src/fetchhead.h',
  'src/filebuf.h',
  'src/fileops.h',
  'src/filter.h',
  'src/fnmatch.h',
  'src/global.h',
  'src/hash.h',
  'src/idxmap.h',
  'src/ignore.h',
  'src/index.h',
  'src/integer.h',
  'src/iterator.h',
  'src/khash.h',
  'src/map.h',
  'src/merge.h',
  'src/merge_driver.h',
  'src/message.h',
  'src/mwindow.h',
  'src/netops.h',
  'src/notes.h',
  'src/object.h',
  'src/odb.h',
  'src/offmap.h',
  'src/oid.h',
  'src/oidarray.h',
  'src/oidmap.h',
  'src/openssl_stream.h',
  'src/pack-objects.h',
  'src/pack.h',
  'src/patch.h',
  'src/patch_generate.h',
  'src/patch_parse.h',
  'src/path.h',
  'src/pathspec.h',
  'src/pool.h',
  'src/posix.h',
  'src/pqueue.h',
  'src/proxy.h',
  'src/push.h',
  'src/refdb.h',
  'src/refdb_fs.h',
  'src/reflog.h',
  'src/refs.h',
  'src/refspec.h',
  'src/remote.h',
  'src/repo_template.h',
  'src/repository.h',
  'src/revwalk.h',
  'src/sha1_lookup.h',
  'src/signature.h',
  'src/socket_stream.h',
  'src/sortedcache.h',
  'src/status.h',
  'src/stransport_stream.h',
  'src/stream.h',
  'src/strmap.h',
  'src/strnlen.h',
  'src/submodule.h',
  'src/sysdir.h',
  'src/tag.h',
  'src/thread-utils.h',
  'src/tls_stream.h',
  'src/trace.h',
  'src/transaction.h',
  'src/transports/auth.h',
  'src/transports/auth_negotiate.h',
  'src/transports/cred.h',
  'src/transports/smart.h',
  'src/transports/ssh.h',
  'src/tree-cache.h',
  'src/tree.h',
  'src/userdiff.h',
  'src/util.h',
  'src/varint.h',
  'src/vector.h',
  'src/xdiff/xdiff.h',
  'src/xdiff/xdiffi.h',
  'src/xdiff/xemit.h',
  'src/xdiff/xinclude.h',
  'src/xdiff/xmacros.h',
  'src/xdiff/xprepare.h',
  'src/xdiff/xtypes.h',
  'src/xdiff/xutils.h',
  'src/zstream.h',
  'src/unix/posix.h',
  'src/unix/pthread.h',
  'deps/zlib/crc32.h',
  'deps/zlib/deflate.h',
  'deps/zlib/inffast.h',
  'deps/zlib/inffixed.h',
  'deps/zlib/inflate.h',
  'deps/zlib/inftrees.h',
  'deps/zlib/trees.h',
  'deps/zlib/zconf.h',
  'deps/zlib/zlib.h',
  'deps/zlib/zutil.h',
  'deps/http-parser/http_parser.h'
)
cm_git2 = static_library(
  'cm_git2',
  cm_git2_src,
  link_args : ['-lpthread'],
  build_by_default : true,
  link_with : [],
  pic : true,
  install : true,
  include_directories : cm_git2_inc,
  c_args : [
    '-D_GNU_SOURCE',
    '-Wno-missing-field-initializers',
    '-Wstrict-aliasing=2',
    '-Wstrict-prototypes',
    '-Wdeclaration-after-statement',
    '-Wno-unused-const-variable',
    '-Wno-unused-function',
    '-g',
    '-DGIT_ARCH_32',
    '-DGIT_THREADS',
    '-DGIT_USE_NSEC',
    '-DGIT_USE_STAT_MTIM',
    '-DHAVE_FUTIMENS',
    '-DHAVE_QSORT_R',
    '-DNO_GZIP',
    '-DNO_VIZ',
    '-DSTDC',
    '-D_FILE_OFFSET_BITS=64'
  ],
  install_dir : 'lib',
  objects : [],
  override_options : []
)
cm_git2_dep = declare_dependency(
  link_with : cm_git2,
  compile_args : [],
  link_args : ['-lpthread'],
  include_directories : cm_git2_inc
)
